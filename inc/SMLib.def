Rem  SMLib.DEF
Rem
Rem  Definition file for library SM: Secure Messaging procedures
Rem ------------------------------------------------------------------
Rem Copyright (C) 1997-2001 ZeitControl GmbH
Rem Do not edit this file. You have a royalty-free right to use, reproduce and 
Rem distribute this file in any way you find useful, provided that you agree 
Rem that ZeitControl GmbH has no warranty, obligations or liability for it.
Rem ------------------------------------------------------------------
Rem
Rem  Terminal Program:
Rem
Rem    Function RetailMac (ReadOnly DesKey$, ReadOnly IV$, ReadOnly Message$, Padding@) As String
Rem    Sub RetailMacStart (State As RetailMacState, ReadOnly IV$)
Rem    Sub RetailMacUpdate (State As RetailMacState, ReadOnly DesKey$, ReadOnly Message$)
Rem    Function RetailMacEnd (ReadOnly State As RetailMacState, ReadOnly DesKey$, ByVal Padding@) As String
Rem
Rem  Professional BasicCard:
Rem
Rem    Function RetailMac (ReadOnly DesKey$, ReadOnly IV$, ReadOnly Message$, Padding@) As String
Rem    Sub RetailMacStart (State As RetailMacState, ReadOnly IV$)
Rem    Sub RetailMacUpdate (State As RetailMacState, ReadOnly DesKey$, ReadOnly Message$)
Rem    Function RetailMacEnd (ReadOnly State As RetailMacState, ReadOnly DesKey$, ByVal Padding@) As String

#IfNotDef SMLibDefIncluded ' Prevent multiple inclusion
Const SMLibDefIncluded = True

Rem  LibError codes

Const SMError                   = &H5001
Const SMMissingMac              = &H5002
Const SMInvalidMac              = &H5003
Const SMRetailMacKeyTooShort    = &H5007
Const SMRetailMacInvalidIV      = &H5008
Const SMRetailMacInvalidPadding = &H5009

Const RetailMacIsoPadding = 1 ' 80 [00 ... 00]
Const RetailMacNoPadding  = 2

Type RetailMacState
  MAC As String*8
  PendingBytes@
End Type

#IfDef TerminalProgram

Declare Function &HD0 50 RetailMac (ReadOnly DesKey$, ReadOnly IV$, ReadOnly Message$, Padding@) As String
Declare Sub      &HD0 51 RetailMacStart (State As RetailMacState, ReadOnly IV$)
Declare Sub      &HD0 52 RetailMacUpdate (State As RetailMacState, ReadOnly DesKey$, ReadOnly Message$)
Declare Function &HD0 53 RetailMacEnd (ReadOnly State As RetailMacState, ReadOnly DesKey$, ByVal Padding@) As String

#ElseIfDef ProfessionalBasicCard

Type SMAlgorithms
  EncAlg%
  MacAlg%
End Type

Type SMCommandFormat
  PlainLength%
  CCLength@
  DataObjects@
End Type

Declare Function &HD0 10 SMDecryptCommand (ByVal Algs As SMAlgorithms, ReadOnly SMKeys$, SSC$,_
                           ByVal CLA@, ByVal INS@, ByVal P1P2%, IDATA$, ByVal Le%) As SMCommandFormat

Declare Function &HD0 50 RetailMac (ReadOnly DesKey$, ReadOnly IV$, ReadOnly Message$, Padding@) As String
Declare Sub      &HD0 51 RetailMacStart (State As RetailMacState, ReadOnly IV$)
Declare Sub      &HD0 52 RetailMacUpdate (State As RetailMacState, ReadOnly DesKey$, ReadOnly Message$)
Declare Function &HD0 53 RetailMacEnd (ReadOnly State As RetailMacState, ReadOnly DesKey$, ByVal Padding@) As String
  
#EndIf

#EndIf ' SMLibDefIncluded
