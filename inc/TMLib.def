Rem  TMLib.DEF
Rem
Rem  Definition file for library TM: Transaction Manager
Rem ------------------------------------------------------------------
Rem Copyright (C) 1997-2001 ZeitControl GmbH
Rem Do not edit this file. You have a royalty-free right to use, reproduce and 
Rem distribute this file in any way you find useful, provided that you agree 
Rem that ZeitControl GmbH has no warranty, obligations or liability for it.
Rem ------------------------------------------------------------------
Rem

#IfNotDef TMLibDefIncluded ' Prevent multiple inclusion
Const TMLibDefIncluded = True

Rem  Old Transaction Manager library

Rem  LibError codes
Const TMTransactionTooLong      = &H5101
Const TMNotInEeprom             = &H5102
Const TMInvalidTransaction      = &H5103
Const TMTooManyStrings          = &H5104
Const TMOutOfMemory             = &H5105

Declare Sub &HD1 1 TMAddTransactionEntry (Transaction$, ReadOnly Dest$, ReadOnly Src$)
Declare Sub &HD1 2 TMCommitTransaction (ReadOnly Transaction$)

Rem  New Transaction Manager library

Rem  LibError codes
Const TM_TransactionNotActive        = &H5110
Const TM_LocalTransactionActive      = &H5111
Const TM_TransactionCounterOverflow  = &H5112

Declare Sub &HD1 &H20 TM_StartLocalTransaction()
Declare Sub &HD1 &H21 TM_CommitLocalTransaction()

Declare Sub &HD1 &H30 TM_StartPersistentTransaction()
Declare Sub &HD1 &H31 TM_CommitPersistentTransaction()

Declare Sub &HD1 &H40 TM_AbortTransaction()

#EndIf ' TMLibDefIncluded