Rem BasicCard Plug-In Library Definition File
Rem ------------------------------------------------------------------
Rem Copyright (C) 1997-2001 ZeitControl GmbH
Rem Do not edit this file. You have a royalty-free right to use, reproduce and 
Rem distribute this file in any way you find useful, provided that you agree 
Rem that ZeitControl GmbH has no warranty, obligations or liability for it.
Rem ------------------------------------------------------------------

Rem  IDEA.DEF
Rem
Rem  Definition file for library IDEA: International Data Encryption Algorithm
Rem
Rem  This library implements the International Data Encryption Algorithm.
Rem
Rem  Note: The International Data Encryption Algorithm may be used free of
Rem  charge for non-commercial purposes. For commercial use, permission must
Rem  be obtained from the patent holders:
Rem
Rem               Ascom Systec Ltd.
Rem               Gewerbepark
Rem               CH-5506 Maegenwil
Rem               Switzerland
Rem
Rem               Internet: http://www.ascom.com/infosec
Rem               e-mail: IDEA@ascom.ch
Rem
Rem  Library procedures:
Rem
Rem  Function IdeaEncrypt (Key$, Data$) As String
Rem  Function IdeaDecrypt (Key$, Data$) As String
Rem
Rem      Parameters:
Rem         Key$   16-byte cryptographic key
Rem         Data$  8-byte data block
Rem
Rem      Return value:
Rem         8-byte data block encrypted or decrypted

#IfNotDef IdeaDefIncluded ' Prevent multiple inclusion
Const IdeaDefIncluded = True

Rem  LibError codes
Const IdeaBadProcParams = &H4301

#IfDef ProfessionalBasicCard
  #Error This library is not available for the Professional BasicCard!
#EndIf

#IfDef TerminalProgram

Declare Function &HC6 100 IdeaEncrypt (ReadOnly Key$, ReadOnly Data$) As String
Declare Function &HC6 200 IdeaDecrypt (ReadOnly Key$, ReadOnly Data$) As String

#Else ' #IfNotDef TerminalProgram

#Library IDEA.LIB

#IfNotDef LibErrorDeclared
Const LibErrorDeclared = True
Public LibError As Integer
#EndIf

Declare Function IdeaLibEncrypt (ReadOnly Key$, ReadOnly Data$) As String
Declare Function IdeaLibDecrypt (ReadOnly Key$, ReadOnly Data$) As String

Function IdeaEncrypt (ReadOnly Key$, ReadOnly Data$) As String
  If Len(Key$) < 16 Or Len(Data$) < 8 Then
    LibError = IdeaBadProcParams
  Else
    IdeaEncrypt = IdeaLibEncrypt (Key$, Data$)
  End If
End Function

Function IdeaDecrypt (ReadOnly Key$, ReadOnly Data$) As String
  If Len(Key$) < 16 Or Len(Data$) < 8 Then
    LibError = IdeaBadProcParams
  Else
    IdeaDecrypt = IdeaLibDecrypt (Key$, Data$)
  End If
End Function

#EndIf ' #IfNotDef TerminalProgram

#EndIf ' IdeaDefIncluded
